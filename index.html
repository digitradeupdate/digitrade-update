<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Digitrade Update Firebase</title>
<style>
body{font-family:Arial,sans-serif;background:#f5f5f5;margin:0;padding:0;}
#topMenuBox{background:#007bff;color:white;padding:15px 20px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 5px rgba(0,0,0,0.2);}
#topMenuBox select,#topMenuBox button{padding:5px 10px;border-radius:5px;border:none;cursor:pointer;}
#topMenuBox select{margin-right:10px;}
.main-container{padding:20px;text-align:center;}
#adminControls{margin:10px 0;display:none;}
#adminControls button{margin:5px;padding:10px 15px;border:none;border-radius:5px;background:#28a745;color:white;cursor:pointer;}
#adminControls button:hover{background:#1e7e34;}
input[type="text"],select,textarea{width:60%;padding:6px;margin:5px 0;border-radius:5px;border:1px solid #ccc;}
#filterButtons button{margin:5px;padding:8px 12px;background:#17a2b8;color:white;border:none;border-radius:5px;cursor:pointer;}
#filterButtons button:hover{background:#117a8b;}
#counter{font-weight:bold;margin-top:10px;color:green;}
#container{margin-top:20px;display:flex;flex-wrap:wrap;justify-content:center;gap:15px;}
.card{background:white;padding:15px;width:280px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,0.1);text-align:left;position:relative;}
.card img{width:100%;height:140px;object-fit:cover;border-radius:8px;margin-bottom:8px;}
.card iframe{width:100%;height:160px;border-radius:8px;margin-top:8px;}
.delete-btn,.edit-btn{position:absolute;top:10px;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;color:white;}
.delete-btn{background:red;right:10px;}
.edit-btn{background:orange;right:60px;}
</style>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>

<div id="topMenuBox">
  <div>
    <select id="languageSelect" onchange="changeLanguage()">
      <option value="en">English</option>
      <option value="ha">Hausa</option>
    </select>
    <button onclick="loginAdmin()">Login Admin</button>
  </div>
  <div id="welcomeMsg"></div>
</div>

<div class="main-container">
  <div id="adminControls">
    <button onclick="addCard()">Æ˜ara Card</button>
    <input type="text" id="searchBox" placeholder="Search Card..." onkeyup="searchCards()">
    <div id="filterButtons">
      <button onclick="filterCategory('All')">All</button>
      <button onclick="filterCategory('Online Works')">Online Works</button>
      <button onclick="filterCategory('Mining')">Mining</button>
      <button onclick="filterCategory('Trading')">Trading</button>
    </div>
  </div>
  <p id="counter">Total Cards: 0</p>
  <div id="container"></div>
</div>

<script>
let isAdmin=false;
const adminPassword="Sawuta24@ADO";

// Firebase config: replace YOUR_CONFIG_HERE with your Firebase project settings
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT_ID.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const cardsCol = db.collection("cards");

function updateCounter(){document.getElementById("counter").innerText="Total Cards: "+document.querySelectorAll(".card").length;}

function renderCard(doc){
  const newDiv=document.createElement("div");
  newDiv.classList.add("card");
  newDiv.dataset.id=doc.id;
  newDiv.dataset.category=doc.data().category;
  newDiv.innerHTML=`
    <img src="${doc.data().img}" alt="banner">
    <h3>${doc.data().title}</h3>
    <p>${doc.data().desc}</p>
    <iframe src="${doc.data().video}" frameborder="0" allowfullscreen></iframe>
    <p><strong>Category:</strong> ${doc.data().category}</p>
    ${isAdmin?'<button class="edit-btn" onclick="editCard(this)">Edit</button><button class="delete-btn" onclick="deleteCard(this)">X</button>':''}
  `;
  document.getElementById("container").appendChild(newDiv);
  updateCounter();
}

// Load all cards
function loadCards(){
  document.getElementById("container").innerHTML="";
  cardsCol.get().then(snapshot=>{snapshot.forEach(doc=>renderCard(doc));});
}

loadCards();

function loginAdmin(){
  let pwd=prompt("Enter Admin Password:");
  if(pwd===adminPassword){
    isAdmin=true;
    document.getElementById("adminControls").style.display="block";
    document.getElementById("welcomeMsg").innerText="Admin Logged In";
    loadCards();
  }else{alert("Wrong Password!");}
}

function addCard(){
  if(!isAdmin){alert("Login Admin first!"); return;}
  let category=prompt("Category: Online Works, Mining, Trading","Online Works");
  let newCard={title:"Card Title",desc:"Description here",img:"https://via.placeholder.com/280x140",video:"https://www.youtube.com/embed/",category};
  cardsCol.add(newCard).then(()=>loadCards());
}

function deleteCard(button){
  let docId=button.parentElement.dataset.id;
  cardsCol.doc(docId).delete().then(()=>loadCards());
}

function editCard(button){
  let card=button.parentElement;
  let docId=card.dataset.id;
  let title=prompt("Edit Title",card.querySelector("h3").innerText);
  let desc=prompt("Edit Desc",card.querySelector("p").innerText);
  if(title && desc){
    cardsCol.doc(docId).update({title,desc}).then(()=>loadCards());
  }
}

function searchCards(){
  let input=document.getElementById("searchBox").value.toLowerCase();
  document.querySelectorAll(".card").forEach(card=>{
    let title=card.querySelector("h3").innerText.toLowerCase();
    card.style.display=title.includes(input)?"block":"none";
  });
}

function filterCategory(category){
  document.querySelectorAll(".card").forEach(card=>{
    card.style.display=(category==="All" || card.dataset.category===category)?"block":"none";
  });
}

function changeLanguage(){
  let lang=document.getElementById("languageSelect").value;
  document.getElementById("searchBox").placeholder=(lang==="ha")?"Nema Card...":"Search Card...";
}
</script>

</body>
</html>